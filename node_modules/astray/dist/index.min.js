!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.astray={})}(this,(function(e){function t(e,r){for(var a,n=0;n<e.length;n++)Array.isArray(a=e[n])?t(a,r):null!=a&&r.push(a);return r}function r(e){if(!e)return e;e.declaration&&(e=e.declaration);let a,n=0,i=[];switch(e.type){case"Identifier":return e.name;case"ImportSpecifier":case"ImportDefaultSpecifier":case"ImportNamespaceSpecifier":return r(e.local);case"VariableDeclarator":case"FunctionDeclaration":return r(e.id);case"VariableDeclaration":for(;n<e.declarations.length;n++)a=r(e.declarations[n]),Array.isArray(a)?t(a,i):a&&i.push(a);return i;case"ImportDeclaration":for(;n<e.specifiers.length;n++)(a=r(e.specifiers[n]))&&i.push(a);return i;case"ObjectPattern":for(;n<e.properties.length;n++)a=r(e.properties[n].value),Array.isArray(a)?t(a,i):a&&i.push(a);return i}}function a(e){if(!e)return e;switch(e.declaration&&(e=e.declaration),e.type){case"VariableDeclaration":return e.declarations;case"ImportDeclaration":return e.specifiers;case"ImportSpecifier":case"ImportDefaultSpecifier":case"ImportNamespaceSpecifier":case"FunctionDeclaration":case"VariableDeclarator":return e}}function n(e,t,r,a){if(!e)return;if("object"!=typeof e)return e;if(Array.isArray(e)){for(let i,o,c=0;c<e.length;c++)i=n(o=e[c],t,r,a),null!=i&&(!1===i?e.splice(c--,1):i!==o&&(e[c]=i));return e}let i,o,c,l=e.type;if(!l)return e;let f=t[l];if(void 0===e.path&&(e.path={parent:a}),f&&("function"==typeof f?c=f(e,r):f.enter&&(c=f.enter(e,r)),null!=c)){if(!0===c)return e;if(!1===c)return!1;c.path=e.path,e=c}for(i in e)if("path"!==i){if(o=e[i],null==o)continue;if("object"!=typeof o)continue;if(c=n(o,t,r,e),null==c)continue;!1===c?delete e[i]:c!==o&&(e[i]=c)}if(f&&f.exit&&(c=f.exit(e,r),null!=c))if(!0===c);else{if(!1===c)return!1;c.path=e.path,e=c}return e}e.REMOVE=!1,e.SKIP=!0,e.lookup=function(e,t){let i=e.path,o=[i],c=!1,l=e;for(i=i.bindings=i.bindings||{};l=l.path.parent;){let e=l.path.bindings||l.path.scoped;if(void 0===e){if(e={},"BlockStatement"===l.type)l.body.length&&n(l.body,{FunctionDeclaration(t){e[t.id.name]=t},VariableDeclarator(t){let a=r(t.id);Array.isArray(a)?a.forEach(r=>e[r]=t):a&&(e[a]=t)}});else if("FunctionDeclaration"===l.type){let t=r(l);t&&(e[t]=e[t]||l),l.params.forEach(a=>{(t=r(a))&&(e[t]=e[t]||a)})}else if("Program"===l.type){let t,n,i=0,o=l.body;for(;i<o.length;i++)(n=a(o[i]))&&[].concat(n).forEach(a=>{t=r(a),e[t]=e[t]||a});c=!0}l.path.scoped=e,l.path.bindings={}}l.path.scanned||o.push(l.path);for(let t in e){let r,a=0,n=o;for(;a<n.length;a++)r=n[a],r.scanned=r.scanned||c,r.bindings[t]=r.bindings[t]||e[t]}if(t&&i[t])break}return i},e.walk=n}));